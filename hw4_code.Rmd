---
title: "ESM 204 HW 4"
author: "Maggie, Van, and Ali"
date: "5/16/2022"
output: 
  html_document:
    code_folding: hide
    theme: yeti
    toc: yes
    toc_depth: 5
    toc_float: yes
    collapsed: yes
    smooth_scroll: yes
    number_sections: no
editor_options:
  chunk_output_type: console
---

```{r setup, include=FALSE, message = FALSE, warning = FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)

library(tidyverse)
library(here)
library(janitor)
library(equatiomatic)
library(broom)
library(ggpubr)
library(kableExtra)

```


```{r}
damage <- read_csv(here("damages.csv"))

warming <- read_csv(here("warming.csv"))
```



## Question 1: Estimate a quadratic damage function


```{r}
# Question 1 work

ggplot(data = damage, aes(x = warming, y = damages)) +
  stat_function(fun = damage_model, color = "purple") +
  geom_point(size = 3) +
  labs(x = "Warming (C)",
       y = "Total Damages ($)") +
  theme_minimal()


damage$warming2 <- damage$warming^2

qm_damages <- lm(damages ~ 0 +  warming + warming2, data = damage)

extract_eq(model = qm_damages, 
           use_coefs = TRUE,
           coef_digits = 4)

damage_model <- function(x){-1059530137756.23*x + 19409275730643.3*x^2}

```


